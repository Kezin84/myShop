<template>
    <div class="container py-5">
      <h3 class="mb-4 fw-bold">沒 ﾄ斉ハg kﾃｽ</h3>
      <form @submit.prevent="handleRegister" class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Tﾃｪn ﾄ惰ハg nh蘯ｭp</label>
          <input v-model="username" required class="form-control" />
        </div>
        <div class="col-md-6">
          <label class="form-label">M蘯ｭt kh蘯ｩu</label>
          <input v-model="password" required type="password" class="form-control" />
        </div>
        <div class="col-12">
          <button class="btn btn-success px-4">ﾄ斉ハg kﾃｽ</button>
          <RouterLink to="/login" class="btn btn-link">ﾄ静｣ cﾃｳ tﾃi kho蘯｣n?</RouterLink>
        </div>
      </form>
    </div>
  </template>
  
  <script setup>
  import { ref } from 'vue'
  import axios from 'axios'
  import { useRouter } from 'vue-router'
  
  const username = ref('')
  const password = ref('')
  const router = useRouter()
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx9PtKQU7BwVz6jD3I4j-SjBJP7zQWJi-ORmex0YAxsdYB6ZeMrZPdtvhnfjeflfy7GRw/exec'
  
  const handleRegister = async () => {
    const formData = new FormData()
    formData.append('action', 'registerUser')
    formData.append('username', username.value)
    formData.append('password', password.value)
  
    const res = await axios.post(SCRIPT_URL, formData)
    const data = res.data
  
    if (data.error) {
      alert(data.message)
    } else {
      alert('ﾄ斉ハg kﾃｽ thﾃnh cﾃｴng!')
      router.push('/login')
    }
  }
  </script>
  